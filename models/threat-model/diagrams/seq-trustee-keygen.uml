@startuml

skinparam sequenceMessageAlign direction
skinparam responseMessageBelowArrow true
autonumber

actor ElectionAdministrator as "Election Administrator"
actor Trustee
entity ElectionAdministrationServer as "Election Administration Server"
entity TrusteeApplication as "Trustee Application"
entity TrusteeAdministrationServer as "Trustee Administration Server"
database ElectionAdministratorStorage as "EA Storage"
database TrusteeStorage as "Trustee Storage"

ElectionAdministrator -> ElectionAdministrationServer: Write election manifest to storage device
ElectionAdministrationServer -> ElectionAdministratorStorage: Write election manifest
ElectionAdministrator -> TrusteeAdministrationServer: Attach storage and start key generation ceremony
TrusteeAdministrationServer <-- ElectionAdministratorStorage: Read election manifest
Trustee -> TrusteeApplication: Attach storage and sign in (one storage\nand trustee application per trustee)
TrusteeStorage --> TrusteeApplication: Trustee private signing and encryption keys
TrusteeApplication -> TrusteeAdministrationServer: Generated encrypted key\nshares and public\nverification values
TrusteeAdministrationServer -> TrusteeApplication: Encrypted key shares and\npublic verification\nvalues from all trustees
TrusteeApplication -> TrusteeAdministrationServer: Generated election public\nkey (one per trustee,\nmust all match)
TrusteeAdministrationServer -> ElectionAdministratorStorage: Write election public key\nand all trustee messages
TrusteeApplication -> TrusteeStorage: Write all trustee messages
ElectionAdministrator <-- TrusteeAdministrationServer: Key generation ceremony complete
Trustee <-- TrusteeApplication: Key generation ceremony complete
@enduml
